(function(d,a){var c=c||{};a(document).ready(function(){a(".wpcf-access-edit-type").click(function(){a(this).hide().parent().find(".wpcf-access-mode").slideToggle()});a(".wpcf-access-edit-type-done").click(function(){a(this).parents(".wpcf-access-mode").slideToggle().parent().find(".wpcf-access-edit-type").show()});a(".wpcf-access-type-item .not-managed").click(function(){a(this).is(":checked")&&a(this).parents(".wpcf-access-mode").find(".follow").is(":checked")==!1?c.EnableInputs(a(this),!0):c.EnableInputs(a(this),
!1)});a(".wpcf-access-type-item .follow").click(function(){a(this).is(":checked")==!1&&a(this).parents(".wpcf-access-mode").find(".not-managed").is(":checked")?c.EnableInputs(a(this),!0):c.EnableInputs(a(this),!1)});a(".wpcf-access-type-item .follow").each(function(){a(this).is(":checked")==!1&&a(this).parents(".wpcf-access-mode").find(".not-managed").is(":checked")?c.EnableInputs(a(this),!0):c.EnableInputs(a(this),!1)});a(".wpcf-access-type-item .not-managed").each(function(){a(this).is(":checked")&&
a(this).parents(".wpcf-access-mode").find(".follow").is(":checked")==!1?c.EnableInputs(a(this),!0):c.EnableInputs(a(this),!1)});a('select[name^="wpcf_access_bulk_set"]').change(function(){var b=a(this).val();b!="0"&&a(this).parent().find("select").each(function(){a(this).val(b)})});a("#wpcf_access_admin_form").on("click",".wpcf-access-change-level",function(){a(this).hide().parent().find(".wpcf-access-custom-roles-select-wrapper").slideDown()});a("#wpcf_access_admin_form").on("click",".wpcf-access-change-level-cancel",
function(){a(this).parent().slideUp().parent().find(".wpcf-access-change-level").show()});a("#wpcf_access_admin_form").on("click",".wpcf-access-change-level-apply",function(){c.ApplyLevels(a(this))});a("#wpcf_access_admin_form").on("click",".wpcf-access-submit",function(){var b=a(this),e=a(this).next();a("#wpcf_access_admin_form").find(".dep-message").hide();e.css("visibility","visible").animate({opacity:1},0);a.ajax({url:ajaxurl,type:"post",data:a("#wpcf_access_admin_form").serialize(),cache:!1,
beforeSend:function(){b.parents(".wpcf-access-type-item").css("background-color","#FFFF9C")},success:function(c){e.animate({opacity:0},200);b.parents(".wpcf-access-type-item").css("background-color","#F7F7F7");""!=c&&a("#wpcf_access_notices").empty().html(c)}});return!1});a("#wpcf-access-new-role .button").click(function(){a("#wpcf-access-new-role .toggle").show().find(".input").val("").focus();a("#wpcf-access-new-role .ajax-response").html("")});a("#wpcf-access-new-role .cancel").click(function(){a("#wpcf-access-new-role .confirm").attr("disabled",
"disabled");a("#wpcf-access-new-role .toggle").hide().find(".input").val("");a("#wpcf-access-new-role .ajax-response").html("")});a("#wpcf-access-new-role .confirm").click(function(){if(a(this).attr("disabled"))return!1;a(this).attr("disabled","disabled");a("#wpcf-access-new-role .img-waiting").show();a("#wpcf-access-new-role .ajax-response").html("");a.ajax({url:ajaxurl,type:"post",dataType:"json",data:"action=wpcf_access_add_role&role="+a("#wpcf-access-new-role .input").val(),cache:!1,beforeSend:function(){},
success:function(b){a("#wpcf-access-new-role .img-waiting").hide();b.error=="false"?(a("#wpcf-access-new-role .input").val(""),a("#wpcf-access-custom-roles-wrapper").html(b.output)):a("#wpcf-access-new-role .ajax-response").html(b.output);d.location="admin.php?page=wpcf-access#custom-roles";d.location.reload(!0)}})});a("#wpcf-access-new-role .input").keyup(function(){a("#wpcf-access-new-role .ajax-response").html("");a(this).val().length>4?a("#wpcf-access-new-role .confirm").removeAttr("disabled"):
a("#wpcf-access-new-role .confirm").attr("disabled","disabled")});a("body").on("click","#wpcf-access-delete-role",function(){a(this).next().show()});a("body").on("click",".wpcf-access-reassign-role-popup .confirm",function(){if(a(this).attr("disabled"))return!1;a(".wpcf-access-reassign-role-popup .img-waiting").show();a.ajax({url:ajaxurl,type:"post",dataType:"json",data:"action=wpcf_access_delete_role&"+a(this).parents(".wpcf-access-reassign-role-popup").find(":input").serialize(),cache:!1,beforeSend:function(){},
success:function(b){a(".wpcf-access-reassign-role-popup .img-waiting").hide();b.error=="false"?(tb_remove(),a("#wpcf-access-custom-roles-wrapper").html(b.output)):a(".wpcf-access-reassign-role-popup .ajax-response").html(b.output);d.location="admin.php?page=wpcf-access#custom-roles";d.location.reload(!0)}})});a(".wpcf-access-reassign-role-popup select").change(function(){a(this).parents(".wpcf-access-reassign-role-popup").find(".confirm").removeAttr("disabled")});a(".wpcf-access-type-item").find(".wpcf-access-mode").prepend('<div class="dep-message" style="display:none;"></div>');
a(':checkbox[value="administrator"]').attr("disabled","disabled").attr("readonly","readonly").attr("checked","checked")});c.Reset=function(b){a("#wpcf_access_admin_form").find(".dep-message").hide();a.ajax({url:b.attr("href")+"&button_id="+b.attr("id"),type:"get",dataType:"json",cache:!1,beforeSend:function(){},success:function(c){if(c!=null&&typeof c.output!="undefined"&&typeof c.button_id!="undefined"){var d=a("#"+c.button_id).parent();a.each(c.output,function(a,c){b=d.find('input[id*="_permissions_'+
a+"_"+c+'_role"]');b.trigger("click").attr("checked","checked")})}}});return!1};c.ApplyLevels=function(b){a.ajax({url:ajaxurl,type:"post",dataType:"json",data:b.parent().find(".wpcf-access-custom-roles-select").serialize()+"&_wpnonce="+wpcf_nonce_ajax_callback+"&action=wpcf_access_ajax_set_level",cache:!1,beforeSend:function(){a("#wpcf-access-custom-roles-table-wrapper").css("opacity",0.5)},success:function(a){if(a!=null&&typeof a.output!="undefined")d.location="admin.php?page=wpcf-access#custom-roles",
d.location.reload(!0)}});return!1};c.Enable=function(a){a.is('input[type="checkbox"]')&&a.is(":checked")||a.is('input[type="radio"]')&&a.val()!="not_managed"?c.EnableInputs(a,!0):c.EnableInputs(a,!1)};c.EnableInputs=function(a,c){c?(a.parent().find(".wpcf-enable-set").val(a.val()),a.parent().parent().parent().find("table input, .wpcf-access-submit, .wpcf-access-reset").not(':checkbox[value="administrator"]').removeAttr("readonly").removeAttr("disabled"),a.parent().parent().parent().find(".warning-fallback").hide()):
(a.parent().find(".wpcf-enable-set").val("not_managed"),a.parent().parent().parent().find("table input, .wpcf-access-reset").attr("readonly","readonly").attr("disabled","disabled"),a.parent().parent().parent().find(".warning-fallback").show())};c.AutoThick=function(b,e,f){var g=[],j=[],k=b.is(":checked"),l=b.val(),i="wpcf_access_dep_true_"+e,h="wpcf_access_dep_false_"+e,m=[];k?typeof d[i]!="undefined"&&(g=g.concat(d[i])):typeof d[h]!="undefined"&&(j=j.concat(d[h]));a.each(g,function(d,e){b.parents("table").find(":checkbox").each(function(){a(this).attr("id")!=
b.attr("id")&&a(this).val()==l&&a(this).hasClass("wpcf-access-"+e)&&(a(this).is(":checked")==!1&&m.push(a(this).data("wpcfaccesscap")),a(this).attr("checked","checked").attr("name",a(this).data("wpcfaccessname")),c.ThickTd(a(this),"prev",!0))})});a.each(j,function(d,e){b.parents("table").find(":checkbox").each(function(){if(a(this).attr("id")!=b.attr("id")&&a(this).val()==l&&a(this).hasClass("wpcf-access-"+e)){a(this).is(":checked")&&m.push(a(this).data("wpcfaccesscap"));a(this).removeAttr("checked").attr("name",
"dummy");var d=a(this).parent().prev().find(":checkbox");d.is(":checked")&&d.attr("checked","checked").attr("name",d.data("wpcfaccessname"));c.ThickTd(a(this),"next",!1)}})});c.ThickTd(b,"next",!1);c.ThickTd(b,"prev",!0);b.is(":checked")?b.attr("name",f):(b.attr("name","dummy"),b.parent().prev().find(":checkbox").attr("checked","checked").attr("name",f));b.val()=="administrator"&&b.attr("name",f).attr("checked","checked");c.DependencyMessageShow(b,e,m,k)};c.ThickTd=function(b,c,d){b=c=="next"?b.parent().nextAll("td").find(":checkbox"):
b.parent().prevAll("td").find(":checkbox");d?b.each(function(){a(this).attr("checked","checked").attr("name","dummy")}):b.each(function(){a(this).removeAttr("checked").attr("name","dummy")})};c.DependencyMessageShow=function(a,d,f,g){d=c.DependencyMessage(d,f,g);a=a.parents(".wpcf-access-type-item").find(".dep-message");a.hide().html("");d!=!1&&a.html(d).show()};c.DependencyMessage=function(b,c,f){var g=d.wpcf_access_dep_active_messages_pattern_singular,j=d.wpcf_access_dep_active_messages_pattern_plural,
k=d.wpcf_access_dep_inactive_messages_pattern_singular,l=d.wpcf_access_dep_inactive_messages_pattern_singular,i=[],h=!1;a.each(c,function(a,c){if(f){var e=d["wpcf_access_dep_true_"+b].indexOf(c);i.push(d["wpcf_access_dep_true_"+b+"_message"][e])}else e=d["wpcf_access_dep_false_"+b].indexOf(c),i.push(d["wpcf_access_dep_false_"+b+"_message"][e])});c.length>0&&(h=f?c.length<2?g.replace("%cap",d["wpcf_access_dep_"+b+"_title"]):j.replace("%cap",d["wpcf_access_dep_"+b+"_title"]):c.length<2?k.replace("%cap",
d["wpcf_access_dep_"+b+"_title"]):l.replace("%cap",d["wpcf_access_dep_"+b+"_title"]),h=h.replace("%dcaps",i.join("', '")));return h};d.wpcfAccess=d.wpcfAccess||{};a.extend(d.wpcfAccess,c)})(window,jQuery);
